<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, user-scalable=no">
    <title>Spyster - Host Display</title>
    <link rel="stylesheet" href="/api/spyster/static/css/styles.css?v=1.0.25">
</head>
<body class="host-display">
    <div class="container">
        <!-- Header -->
        <header role="banner" class="header">
            <h1 class="site-logo"><span class="logo-spy">SPY</span><span class="logo-ster">STER</span></h1>
        </header>

        <!-- Phase Transition Overlay (Story 7.2) -->
        <div id="phase-transition-overlay" class="phase-transition-overlay hidden" role="alert" aria-live="assertive">
            <div class="phase-transition-content">
                <span id="phase-transition-text" class="phase-transition-text"></span>
            </div>
        </div>

        <!-- Main Content Area -->
        <main role="main" class="main-content">
            <!-- Lobby Phase: 3-Step Flow -->
            <section id="lobby-section" class="phase-section" role="region" aria-labelledby="lobby-heading">
                <!-- Step 1: Game Settings -->
                <div id="lobby-step-1" class="lobby-step">
                    <div class="config-panel">
                        <h2>Game Settings</h2>

                        <!-- Round Duration -->
                        <div class="config-option">
                            <label id="config-round-duration-label">Round Duration (minutes)</label>
                            <div class="config-controls" role="group" aria-labelledby="config-round-duration-label">
                                <button
                                    id="config-round-duration-dec"
                                    class="config-btn"
                                    aria-label="Decrease round duration">
                                    −
                                </button>
                                <span id="config-round-duration-value" class="config-value" role="status" aria-live="polite">7</span>
                                <button
                                    id="config-round-duration-inc"
                                    class="config-btn"
                                    aria-label="Increase round duration">
                                    +
                                </button>
                            </div>
                        </div>

                        <!-- Number of Rounds -->
                        <div class="config-option">
                            <label id="config-num-rounds-label">Number of Rounds</label>
                            <div class="config-controls" role="group" aria-labelledby="config-num-rounds-label">
                                <button
                                    id="config-num-rounds-dec"
                                    class="config-btn"
                                    aria-label="Decrease number of rounds">
                                    −
                                </button>
                                <span id="config-num-rounds-value" class="config-value" role="status" aria-live="polite">5</span>
                                <button
                                    id="config-num-rounds-inc"
                                    class="config-btn"
                                    aria-label="Increase number of rounds">
                                    +
                                </button>
                            </div>
                        </div>

                        <!-- Location Pack -->
                        <div class="config-option">
                            <label for="config-location-pack">Location Pack</label>
                            <select
                                id="config-location-pack"
                                class="config-select"
                                aria-label="Select location pack">
                                <option value="classic" selected>Classic</option>
                            </select>
                        </div>
                    </div>

                    <div class="lobby-step-actions">
                        <button id="settings-next-btn" class="btn btn-primary btn-large" aria-label="Continue to host setup">
                            NEXT
                        </button>
                    </div>
                </div>

                <!-- Step 2: Host Name Entry -->
                <div id="lobby-step-2" class="lobby-step hidden">
                    <div class="host-join-section">
                        <h2 class="step-heading">Enter Your Name</h2>
                        <p class="step-description">You'll join the game as a player</p>
                        <div class="host-join-controls">
                            <input
                                type="text"
                                id="host-name-input"
                                placeholder="Your name"
                                maxlength="20"
                                autocomplete="off"
                                class="host-name-input"
                                aria-label="Enter your name to join as a player"
                            >
                        </div>
                        <p id="host-join-status" class="host-join-status"></p>
                    </div>

                    <div class="lobby-step-actions">
                        <button id="invite-players-btn" class="btn btn-primary btn-large" disabled aria-label="Invite players to join">
                            INVITE PLAYERS
                        </button>
                    </div>
                </div>

                <!-- Step 3: QR Code & Player List -->
                <div id="lobby-step-3" class="lobby-step hidden">
                    <h2 id="lobby-heading">Scan to Join</h2>
                    <div class="qr-code-wrapper">
                        <div id="qr-code-container" aria-label="QR Code to join game"></div>
                    </div>
                    <p class="join-url" id="join-url-text" aria-label="Join URL"></p>
                    <div class="player-count" aria-live="polite" aria-atomic="true">
                        <span id="current-player-count">0</span> /
                        <span id="max-player-count">10</span> players
                    </div>

                    <!-- Player List -->
                    <div id="player-list-section" class="player-list-section">
                        <div id="player-list"></div>
                    </div>

                    <!-- Game Controls -->
                    <div class="game-controls">
                        <button
                            id="start-game-btn"
                            class="btn btn-primary btn-large"
                            disabled
                            aria-label="Start game"
                        >
                            START GAME
                        </button>
                        <div id="start-message" class="help-text" aria-live="polite"></div>
                    </div>
                </div>
            </section>

            <!-- Placeholder for future phases -->
            <section id="roles-section" class="phase-section hidden" role="region" aria-labelledby="roles-heading">
                <h2 id="roles-heading">Role Assignment</h2>
                <p>Roles are being assigned...</p>
            </section>

            <!-- Questioning Phase (Story 4.3) -->
            <section id="questioning-section" class="phase-section hidden" role="region" aria-labelledby="questioning-heading">
                <div class="phase-header">
                    <h2 id="questioning-heading">Questioning Phase</h2>
                    <div id="round-timer-host" class="timer-display large" role="timer" aria-live="polite">
                        <span class="timer-value">0:00</span>
                    </div>
                </div>

                <!-- Current Turn Display -->
                <div id="turn-display" class="turn-indicator" role="region" aria-labelledby="turn-label">
                    <div id="turn-label" class="turn-label">CURRENT TURN</div>
                    <div class="turn-info">
                        <div class="questioner-box">
                            <div class="role-label">ASKING</div>
                            <div id="questioner-name" class="player-name-large" aria-live="polite">
                                Waiting...
                            </div>
                        </div>
                        <div class="turn-arrow" aria-hidden="true">→</div>
                        <div class="answerer-box">
                            <div class="role-label">ANSWERING</div>
                            <div id="answerer-name" class="player-name-large" aria-live="polite">
                                Waiting...
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Player Status Grid -->
                <div id="player-status-grid" class="player-grid" role="list" aria-label="Player connection status">
                    <!-- Populated by JavaScript -->
                </div>

                <!-- Host Controls (Story 4.3: AC5) -->
                <div class="host-controls" style="margin-top: var(--space-xl); text-align: center;">
                    <button
                        id="next-turn-btn"
                        class="btn btn-primary btn-large"
                        aria-label="Advance to next turn"
                    >
                        NEXT TURN
                    </button>
                </div>
            </section>

            <!-- Voting Phase (Story 7.4) -->
            <section id="vote-section" class="phase-section hidden" role="region" aria-labelledby="vote-heading">
                <div class="phase-header">
                    <h2 id="vote-heading">Voting Phase</h2>
                    <div id="vote-timer-host" class="timer-display large" role="timer" aria-live="polite">
                        <span class="timer-value">60</span>
                    </div>
                </div>

                <!-- Submission Tracker (Task 1) -->
                <div class="submission-tracker" aria-live="polite">
                    <div class="tracker-ring-container">
                        <svg class="progress-ring" viewBox="0 0 120 120" aria-hidden="true">
                            <circle class="progress-ring-bg" cx="60" cy="60" r="52" />
                            <circle id="progress-ring-fill" class="progress-ring-fill" cx="60" cy="60" r="52" />
                        </svg>
                        <div class="tracker-count">
                            <span id="vote-count" class="count-current">0</span>
                            <span class="count-separator">/</span>
                            <span id="vote-total" class="count-total">0</span>
                        </div>
                    </div>
                    <span class="tracker-label">players voted</span>
                </div>

                <!-- Voting Status Message -->
                <div id="vote-status-message" class="status-message" aria-live="polite">
                    Waiting for all players to submit their votes...
                </div>
            </section>

            <!-- Reveal Phase (Story 7.4) -->
            <section id="reveal-section" class="phase-section hidden" role="region" aria-labelledby="reveal-heading">
                <h2 id="reveal-heading" class="sr-only">Reveal Phase</h2>

                <!-- Reveal Stage Text -->
                <div id="reveal-stage-text" class="reveal-stage-text" aria-live="assertive">
                    Votes are in...
                </div>

                <!-- Vote Cards Grid (Task 2) -->
                <div id="vote-cards-grid" class="vote-cards-grid" role="list" aria-label="Player votes">
                    <!-- Vote cards populated by JavaScript -->
                </div>

                <!-- Conviction Overlay (Task 4) -->
                <div id="conviction-overlay" class="conviction-overlay hidden" role="alert" aria-live="assertive">
                    <div class="conviction-content">
                        <div id="conviction-verdict" class="conviction-verdict"></div>
                        <div id="conviction-details" class="conviction-details"></div>
                        <div id="spy-reveal" class="spy-reveal hidden">
                            <span class="spy-label">THE SPY WAS</span>
                            <span id="spy-name" class="spy-name"></span>
                        </div>
                    </div>
                </div>
            </section>

            <section id="scoring-section" class="phase-section hidden" role="region" aria-labelledby="scoring-heading">
                <h2 id="scoring-heading">Scoring</h2>
                <p>Calculating scores...</p>
            </section>

            <section id="end-section" class="phase-section hidden" role="region" aria-labelledby="end-heading">
                <h2 id="end-heading">Game Over</h2>
                <p>Final results</p>
            </section>
        </main>

        <!-- Footer -->
        <footer role="contentinfo" class="footer">
            <div class="status-indicator">
                <span id="connection-status" class="status-dot" role="status"></span>
                <span id="status-text" aria-live="polite">Connecting...</span>
            </div>
        </footer>

        <!-- Admin Bar (Story 7.5) -->
        <div id="admin-bar" class="admin-bar collapsed" data-phase="LOBBY" role="toolbar" aria-label="Game admin controls">
            <button id="admin-toggle" class="admin-toggle" aria-label="Toggle admin controls" aria-expanded="false">
                <span class="toggle-icon" aria-hidden="true">⚙</span>
            </button>
            <div class="admin-controls">
                <button id="btn-skip-vote" class="admin-btn" data-phases="QUESTIONING" aria-label="Skip to voting phase">
                    SKIP TO VOTE
                </button>
                <button id="btn-next-round" class="admin-btn" data-phases="SCORING" aria-label="Start next round">
                    NEXT ROUND
                </button>
                <button id="btn-pause" class="admin-btn" data-phases="QUESTIONING,VOTE" aria-label="Pause game">
                    PAUSE
                </button>
                <button id="btn-end-game" class="admin-btn danger" data-phases="*" aria-label="End game">
                    END GAME
                </button>
            </div>
        </div>

        <!-- Paused Overlay (Story 7.5) -->
        <div id="paused-overlay" class="paused-overlay hidden" role="alert" aria-live="assertive">
            <div class="paused-content">
                <span class="paused-text">PAUSED</span>
                <span class="paused-hint">Host can resume the game</span>
            </div>
        </div>

        <!-- Confirmation Modal (Story 7.5) -->
        <div id="confirm-modal" class="confirm-modal hidden" role="dialog" aria-modal="true" aria-labelledby="modal-title">
            <div class="modal-backdrop"></div>
            <div class="modal-content">
                <h3 id="modal-title" class="modal-title">End Game?</h3>
                <p id="modal-message" class="modal-message">Current scores will be final. Are you sure?</p>
                <div class="modal-actions">
                    <button id="modal-cancel" class="btn btn-secondary" aria-label="Cancel">Cancel</button>
                    <button id="modal-confirm" class="btn btn-danger" aria-label="Confirm end game">End Game</button>
                </div>
            </div>
        </div>
    </div>

    <!-- JavaScript -->
    <script src="/api/spyster/static/js/vendor/qrcode.min.js?v=1.0.25"></script>
    <script src="/api/spyster/static/js/host.js?v=1.0.25"></script>
</body>
</html>
